# Система Контроля Версий для Конфигурационных Файлов

Это простая система контроля версий, специально разработанная для отслеживания изменений в конфигурационных файлах. Система позволяет отслеживать изменения файлов в реальном времени, сохранять версии, просматривать историю изменений, сравнивать версии и выполнять откат к предыдущим версиям.

## Зависимости

Для работы системы требуются следующие компоненты:

- Python 3.x
- watchdog (для мониторинга файловой системы)
- sqlite3 (входит в стандартную библиотеку Python)
- bash (для запуска тестов)

Установка зависимостей:
```bash
pip3 install watchdog
```

## Структура проекта

- `version_control.py` - основной скрипт системы контроля версий
- `test_version_control.sh` - bash-скрипт для тестирования функциональности
- `configs/` - директория для конфигурационных файлов (создаётся автоматически)
- `versions.db` - база данных SQLite для хранения версий (создаётся автоматически)

## Функциональность

### Основные возможности:

1. Мониторинг изменений файлов в реальном времени
2. Сохранение версий файлов в базе данных SQLite
3. Просмотр истории изменений
4. Сравнение различных версий файлов
5. Откат к предыдущим версиям

### Команды

#### Запуск мониторинга:
```bash
python3 version_control.py monitor --config_dir ./configs --db_path ./versions.db
```

#### Просмотр истории изменений:
```bash
python3 version_control.py history --file ./configs/example.conf --config_dir ./configs --db_path ./versions.db
```

#### Сравнение версий:
```bash
python3 version_control.py compare --file ./configs/example.conf --version1 1 --version2 2 --config_dir ./configs --db_path ./versions.db
```

#### Откат к определённой версии:
```bash
python3 version_control.py rollback --file ./configs/example.conf --rollback_version 1 --config_dir ./configs --db_path ./versions.db
```

## Тестирование

Для запуска тестов используйте скрипт `test_version_control.sh`:

```bash
chmod +x test_version_control.sh
./test_version_control.sh
```

Тестовый скрипт выполняет следующие проверки:

1. Подготовка тестового окружения
2. Запуск мониторинга
3. Тестирование модификаций файлов
4. Проверка просмотра истории
5. Проверка сравнения версий
6. Тестирование отката к предыдущей версии
7. Очистка тестового окружения

### Особенности тестового скрипта:

- Автоматическое создание и очистка тестового окружения
- Обработка сигналов прерывания
- Корректное завершение процессов мониторинга
- Цветной вывод результатов тестов
- Подробные сообщения об ошибках

## Особенности реализации

- Многопоточная обработка изменений файлов
- Хранение полного содержимого файлов в базе данных
- Отслеживание автора изменений через переменные окружения
- Относительные пути для переносимости
- Поддержка рекурсивного мониторинга директорий

## Ограничения

- Система предназначена для работы с текстовыми конфигурационными файлами
- Требуются права на чтение/запись в директории конфигурации и базы данных
- При больших объёмах данных размер базы данных может существенно вырасти

## Рекомендации по использованию

1. Регулярно создавайте резервные копии базы данных
2. Используйте относительные пути для лучшей переносимости
3. Следите за свободным местом на диске при работе с большими файлами
4. При необходимости периодически очищайте старые версии файлов
